import{M as N}from"./mock-BnFOwhRk.js";import{v as oe}from"./vehicle-lBh_cm1j.js";import{d as se,r as k,B as z,c as G,h as x,e,w as a,b as u,o as f,f as D,j as d,a as w,t as v,G as de,F as R,i as T,C as ie,E as h,_ as ue}from"./index-Dj8K2Q4U.js";const re=N.mock({"records|30":[{"id|+1":1,"vehicleId|1-20":1,inspectionDate:'@date("yyyy-MM-dd")',nextInspectionDate:'@date("yyyy-MM-dd")',"cost|200-800":1,"station|1":["兖州车管所","济宁市车管所","邹城检测站","曲阜检测站"],"result|1":["pass","fail","pending"],items:()=>{const $=["尾气检测","制动性能","灯光检测","车辆外观","安全装置"];return N.Random.shuffle($).slice(0,N.Random.integer(3,5))},inspector:"@cname",remarks:"@csentence(10, 20)"}]}),pe={class:"inspection-list"},me={class:"card-header"},ce={class:"alert-title"},fe={class:"dialog-footer"},be=se({__name:"InspectionList",setup($){const c=k(re.records),C=k(oe.vehicles),_=k(!1),I=k("add"),U=k(!1),p=z({vehicleId:"",station:"",result:""}),o=z({id:"",vehicleId:"",inspectionDate:"",nextInspectionDate:"",station:"",items:[],cost:0,inspector:"",result:"",remarks:""}),M=G(()=>{const n=new Date;return n.setDate(n.getDate()+30),c.value.filter(l=>{const s=new Date(l.nextInspectionDate);return s<=n&&s>=new Date})}),P=G(()=>c.value.filter(n=>{const l=!p.vehicleId||n.vehicleId===p.vehicleId,s=!p.station||n.station===p.station,g=!p.result||n.result===p.result;return l&&s&&g})),B=n=>{const l=C.value.find(s=>s.id===n);return l?l.plateNumber:"-"},q=n=>({pass:"success",fail:"danger",pending:"warning"})[n],H=n=>({pass:"通过",fail:"未通过",pending:"待检"})[n],J=n=>{const l=new Date(n),s=new Date,g=l.getTime()-s.getTime();return Math.ceil(g/(1e3*60*60*24))},K=()=>{},Q=()=>{Object.assign(p,{vehicleId:"",station:"",result:""})},F=()=>{I.value="add",_.value=!0,Object.assign(o,{id:"",vehicleId:"",inspectionDate:"",nextInspectionDate:"",station:"",items:[],cost:0,inspector:"",result:"",remarks:""})},W=n=>{I.value="edit",_.value=!0,Object.assign(o,n)},X=n=>{ie.confirm("确定要删除该年检记录吗？","提示",{type:"warning"}).then(()=>{c.value=c.value.filter(l=>l.id!==n.id),h.success("删除成功")})},Y=n=>{console.log("查看年检报告:",n),h.info("年检报告功能开发中...")},Z=n=>{F(),o.vehicleId=n.vehicleId},ee=()=>{if(I.value==="add"){const n={...o,id:String(c.value.length+1)};c.value.unshift(n),h.success("新增年检记录成功")}else{const n=c.value.findIndex(l=>l.id===o.id);n!==-1&&(c.value[n]={...o},h.success("更新年检记录成功"))}_.value=!1},le=n=>{console.log("查看记录:",n)};return(n,l)=>{const s=u("el-button"),g=u("el-alert"),i=u("el-option"),V=u("el-select"),m=u("el-form-item"),S=u("el-form"),r=u("el-table-column"),E=u("el-tag"),j=u("el-table"),te=u("el-card"),L=u("el-date-picker"),y=u("el-checkbox"),ae=u("el-checkbox-group"),ne=u("el-input-number"),O=u("el-input"),A=u("el-dialog");return f(),x("div",pe,[e(te,null,{header:a(()=>[D("div",me,[l[17]||(l[17]=D("span",null,"年检记录管理",-1)),e(s,{type:"primary",onClick:F},{default:a(()=>l[16]||(l[16]=[d("新增年检记录")])),_:1})])]),default:a(()=>[M.value.length>0?(f(),w(g,{key:0,type:"warning",closable:!1,class:"alert-box"},{title:a(()=>[D("div",ce,[d(" 有 "+v(M.value.length)+" 辆车即将到期年检 ",1),e(s,{type:"primary",link:"",onClick:l[0]||(l[0]=t=>U.value=!0)},{default:a(()=>l[18]||(l[18]=[d(" 查看详情 ")])),_:1})])]),_:1})):de("",!0),e(S,{inline:!0,class:"search-form"},{default:a(()=>[e(m,{label:"车辆"},{default:a(()=>[e(V,{modelValue:p.vehicleId,"onUpdate:modelValue":l[1]||(l[1]=t=>p.vehicleId=t),placeholder:"请选择车辆",clearable:""},{default:a(()=>[(f(!0),x(R,null,T(C.value,t=>(f(),w(i,{key:t.id,label:t.plateNumber,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"检测站"},{default:a(()=>[e(V,{modelValue:p.station,"onUpdate:modelValue":l[2]||(l[2]=t=>p.station=t),placeholder:"请选择检测站",clearable:""},{default:a(()=>[e(i,{label:"兖州车管所",value:"兖州车管所"}),e(i,{label:"济宁市车管所",value:"济宁市车管所"}),e(i,{label:"邹城检测站",value:"邹城检测站"}),e(i,{label:"曲阜检测站",value:"曲阜检测站"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"检测结果"},{default:a(()=>[e(V,{modelValue:p.result,"onUpdate:modelValue":l[3]||(l[3]=t=>p.result=t),placeholder:"请选择结果",clearable:""},{default:a(()=>[e(i,{label:"通过",value:"pass"}),e(i,{label:"未通过",value:"fail"}),e(i,{label:"待检",value:"pending"})]),_:1},8,["modelValue"])]),_:1}),e(m,null,{default:a(()=>[e(s,{type:"primary",onClick:K},{default:a(()=>l[19]||(l[19]=[d("查询")])),_:1}),e(s,{onClick:Q},{default:a(()=>l[20]||(l[20]=[d("重置")])),_:1})]),_:1})]),_:1}),e(j,{data:P.value,border:""},{default:a(()=>[e(r,{prop:"id",label:"记录编号",width:"100"}),e(r,{label:"车牌号",width:"120"},{default:a(({row:t})=>[d(v(B(t.vehicleId)),1)]),_:1}),e(r,{prop:"inspectionDate",label:"检测日期",width:"120"}),e(r,{prop:"nextInspectionDate",label:"下次年检日期",width:"120"}),e(r,{prop:"station",label:"检测站",width:"150"}),e(r,{prop:"inspector",label:"检测员",width:"100"}),e(r,{prop:"items",label:"检测项目"},{default:a(({row:t})=>[(f(!0),x(R,null,T(t.items,b=>(f(),w(E,{key:b,size:"small",class:"mx-1"},{default:a(()=>[d(v(b),1)]),_:2},1024))),128))]),_:1}),e(r,{prop:"cost",label:"检测费用",width:"100"},{default:a(({row:t})=>[d(" ¥"+v(t.cost.toFixed(2)),1)]),_:1}),e(r,{prop:"result",label:"检测结果",width:"100"},{default:a(({row:t})=>[e(E,{type:q(t.result)},{default:a(()=>[d(v(H(t.result)),1)]),_:2},1032,["type"])]),_:1}),e(r,{label:"操作",width:"200",fixed:"right"},{default:a(({row:t})=>[e(s,{type:"primary",link:"",onClick:b=>le(t)},{default:a(()=>l[21]||(l[21]=[d("查看")])),_:2},1032,["onClick"]),e(s,{type:"primary",link:"",onClick:b=>W(t)},{default:a(()=>l[22]||(l[22]=[d("编辑")])),_:2},1032,["onClick"]),e(s,{type:"danger",link:"",onClick:b=>X(t)},{default:a(()=>l[23]||(l[23]=[d("删除")])),_:2},1032,["onClick"]),e(s,{type:"info",link:"",onClick:b=>Y(t)},{default:a(()=>l[24]||(l[24]=[d("查看报告")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1}),e(A,{modelValue:_.value,"onUpdate:modelValue":l[14]||(l[14]=t=>_.value=t),title:I.value==="add"?"新增年检记录":"编辑年检记录",width:"600px"},{footer:a(()=>[D("span",fe,[e(s,{onClick:l[13]||(l[13]=t=>_.value=!1)},{default:a(()=>l[25]||(l[25]=[d("取消")])),_:1}),e(s,{type:"primary",onClick:ee},{default:a(()=>l[26]||(l[26]=[d("确定")])),_:1})])]),default:a(()=>[e(S,{model:o,"label-width":"100px"},{default:a(()=>[e(m,{label:"车辆"},{default:a(()=>[e(V,{modelValue:o.vehicleId,"onUpdate:modelValue":l[4]||(l[4]=t=>o.vehicleId=t),placeholder:"请选择车辆"},{default:a(()=>[(f(!0),x(R,null,T(C.value,t=>(f(),w(i,{key:t.id,label:t.plateNumber,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"检测日期"},{default:a(()=>[e(L,{modelValue:o.inspectionDate,"onUpdate:modelValue":l[5]||(l[5]=t=>o.inspectionDate=t),type:"date",placeholder:"选择日期"},null,8,["modelValue"])]),_:1}),e(m,{label:"下次年检日期"},{default:a(()=>[e(L,{modelValue:o.nextInspectionDate,"onUpdate:modelValue":l[6]||(l[6]=t=>o.nextInspectionDate=t),type:"date",placeholder:"选择日期"},null,8,["modelValue"])]),_:1}),e(m,{label:"检测站"},{default:a(()=>[e(V,{modelValue:o.station,"onUpdate:modelValue":l[7]||(l[7]=t=>o.station=t),placeholder:"请选择检测站"},{default:a(()=>[e(i,{label:"兖州车管所",value:"兖州车管所"}),e(i,{label:"济宁市车管所",value:"济宁市车管所"}),e(i,{label:"邹城检测站",value:"邹城检测站"}),e(i,{label:"曲阜检测站",value:"曲阜检测站"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"检测项目"},{default:a(()=>[e(ae,{modelValue:o.items,"onUpdate:modelValue":l[8]||(l[8]=t=>o.items=t)},{default:a(()=>[e(y,{label:"尾气检测"}),e(y,{label:"制动性能"}),e(y,{label:"灯光检测"}),e(y,{label:"车辆外观"}),e(y,{label:"安全装置"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"检测费用"},{default:a(()=>[e(ne,{modelValue:o.cost,"onUpdate:modelValue":l[9]||(l[9]=t=>o.cost=t),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1}),e(m,{label:"检测员"},{default:a(()=>[e(O,{modelValue:o.inspector,"onUpdate:modelValue":l[10]||(l[10]=t=>o.inspector=t)},null,8,["modelValue"])]),_:1}),e(m,{label:"检测结果"},{default:a(()=>[e(V,{modelValue:o.result,"onUpdate:modelValue":l[11]||(l[11]=t=>o.result=t),placeholder:"请选择结果"},{default:a(()=>[e(i,{label:"通过",value:"pass"}),e(i,{label:"未通过",value:"fail"}),e(i,{label:"待检",value:"pending"})]),_:1},8,["modelValue"])]),_:1}),e(m,{label:"备注"},{default:a(()=>[e(O,{modelValue:o.remarks,"onUpdate:modelValue":l[12]||(l[12]=t=>o.remarks=t),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(A,{modelValue:U.value,"onUpdate:modelValue":l[15]||(l[15]=t=>U.value=t),title:"即将到期年检车辆",width:"800px"},{default:a(()=>[e(j,{data:M.value,border:""},{default:a(()=>[e(r,{label:"车牌号"},{default:a(({row:t})=>[d(v(B(t.vehicleId)),1)]),_:1}),e(r,{prop:"nextInspectionDate",label:"年检到期日"}),e(r,{label:"剩余天数"},{default:a(({row:t})=>[d(v(J(t.nextInspectionDate))+"天 ",1)]),_:1}),e(r,{label:"操作",width:"200"},{default:a(({row:t})=>[e(s,{type:"primary",onClick:b=>Z(t)},{default:a(()=>l[27]||(l[27]=[d(" 创建年检记录 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])])}}}),ge=ue(be,[["__scopeId","data-v-ea92067e"]]);export{ge as default};
