import{m as K}from"./maintenanceRecord-ChkbKy16.js";import{v as Q}from"./vehicle-DpWRqzrQ.js";import{d as W,r as y,B as I,c as X,h as w,e,w as t,b as u,o as v,f as h,j as m,F as C,i as U,t as x,C as Y,E as T,a as R,_ as Z}from"./index-uYQj0kvs.js";import"./mock-CdG3V9JI.js";const ee={class:"maintenance-list"},le={class:"card-header"},ae={class:"dialog-footer"},te=W({__name:"MaintenanceList",setup(ne){const c=y([]),D=y(Q.vehicles),_=y(!1),g=y("add"),s=I({vehicleId:"",maintenanceType:"",dateRange:[]}),n=I({id:"",vehicleId:"",maintenanceType:"",maintenanceDate:"",cost:0,garage:"",description:"",nextMaintenanceDate:"",status:"pending"}),M=X(()=>c.value.filter(o=>{var f;const l=!s.vehicleId||o.vehicleId===s.vehicleId,r=!s.maintenanceType||o.maintenanceType===s.maintenanceType;let d=!0;if(((f=s.dateRange)==null?void 0:f.length)===2){const i=new Date(o.maintenanceDate),b=new Date(s.dateRange[0]),V=new Date(s.dateRange[1]);d=i>=b&&i<=V}return l&&r&&d})),N=o=>{const l=D.value.find(r=>r.id===o);return l?l.plateNumber:"-"},S=o=>({pending:"info",processing:"warning",completed:"success"})[o],B=o=>({pending:"待处理",processing:"维修中",completed:"已完成"})[o],E=()=>{},F=()=>{Object.assign(s,{vehicleId:"",maintenanceType:"",dateRange:[]})},j=()=>{g.value="add",_.value=!0,Object.assign(n,{id:"",vehicleId:"",maintenanceType:"",maintenanceDate:"",cost:0,garage:"",description:"",nextMaintenanceDate:"",status:"pending"})},L=o=>{g.value="edit",_.value=!0,Object.assign(n,o)},O=o=>{Y.confirm("确定要删除该维修记录吗？","提示",{type:"warning"}).then(()=>{c.value=c.value.filter(l=>l.id!==o.id),T.success("删除成功")})},$=()=>{if(g.value==="add"){const o={...n,id:String(c.value.length+1)};c.value.unshift(o),T.success("新增维修记录成功")}else{const o=c.value.findIndex(l=>l.id===n.id);o!==-1&&(c.value[o]={...n},T.success("更新维修记录成功"))}_.value=!1};return c.value=K.records,(o,l)=>{const r=u("el-button"),d=u("el-option"),f=u("el-select"),i=u("el-form-item"),b=u("el-date-picker"),V=u("el-form"),p=u("el-table-column"),z=u("el-tag"),A=u("el-button-group"),P=u("el-table"),q=u("el-card"),G=u("el-input-number"),k=u("el-input"),H=u("el-dialog");return v(),w("div",ee,[e(q,null,{header:t(()=>[h("div",le,[l[13]||(l[13]=h("span",null,"维修保养记录管理",-1)),e(r,{type:"primary",onClick:j},{default:t(()=>l[12]||(l[12]=[m("新增维修记录")])),_:1})])]),default:t(()=>[e(V,{inline:!0,class:"search-form"},{default:t(()=>[e(i,{label:"车辆"},{default:t(()=>[e(f,{modelValue:s.vehicleId,"onUpdate:modelValue":l[0]||(l[0]=a=>s.vehicleId=a),placeholder:"请选择车辆",clearable:""},{default:t(()=>[(v(!0),w(C,null,U(D.value,a=>(v(),R(d,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"维修类型"},{default:t(()=>[e(f,{modelValue:s.maintenanceType,"onUpdate:modelValue":l[1]||(l[1]=a=>s.maintenanceType=a),placeholder:"请选择类型",clearable:""},{default:t(()=>[e(d,{label:"定期保养",value:"定期保养"}),e(d,{label:"故障维修",value:"故障维修"}),e(d,{label:"轮胎更换",value:"轮胎更换"}),e(d,{label:"油液更换",value:"油液更换"}),e(d,{label:"制动系统维修",value:"制动系统维修"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"维修日期"},{default:t(()=>[e(b,{modelValue:s.dateRange,"onUpdate:modelValue":l[2]||(l[2]=a=>s.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(r,{type:"primary",onClick:E},{default:t(()=>l[14]||(l[14]=[m("查询")])),_:1}),e(r,{onClick:F},{default:t(()=>l[15]||(l[15]=[m("重置")])),_:1})]),_:1})]),_:1}),e(P,{data:M.value,border:""},{default:t(()=>[e(p,{prop:"id",label:"记录编号",width:"100"}),e(p,{label:"车牌号",width:"120"},{default:t(({row:a})=>[m(x(N(a.vehicleId)),1)]),_:1}),e(p,{prop:"maintenanceType",label:"维修类型",width:"120"}),e(p,{prop:"maintenanceDate",label:"维修日期",width:"120"}),e(p,{prop:"cost",label:"维修费用",width:"120"},{default:t(({row:a})=>[m(" ¥"+x(a.cost.toFixed(2)),1)]),_:1}),e(p,{prop:"garage",label:"维修厂",width:"150"}),e(p,{prop:"description",label:"维修内容","show-overflow-tooltip":""}),e(p,{prop:"nextMaintenanceDate",label:"下次保养日期",width:"120"}),e(p,{prop:"status",label:"状态",width:"100"},{default:t(({row:a})=>[e(z,{type:S(a.status)},{default:t(()=>[m(x(B(a.status)),1)]),_:2},1032,["type"])]),_:1}),e(p,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[e(A,null,{default:t(()=>[e(r,{type:"primary",size:"small",onClick:J=>L(a)},{default:t(()=>l[16]||(l[16]=[m("编辑")])),_:2},1032,["onClick"]),e(r,{type:"danger",size:"small",onClick:J=>O(a)},{default:t(()=>l[17]||(l[17]=[m("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),e(H,{modelValue:_.value,"onUpdate:modelValue":l[11]||(l[11]=a=>_.value=a),title:g.value==="add"?"新增维修记录":"编辑维修记录",width:"600px"},{footer:t(()=>[h("span",ae,[e(r,{onClick:l[10]||(l[10]=a=>_.value=!1)},{default:t(()=>l[18]||(l[18]=[m("取消")])),_:1}),e(r,{type:"primary",onClick:$},{default:t(()=>l[19]||(l[19]=[m("确定")])),_:1})])]),default:t(()=>[e(V,{model:n,"label-width":"100px"},{default:t(()=>[e(i,{label:"车辆"},{default:t(()=>[e(f,{modelValue:n.vehicleId,"onUpdate:modelValue":l[3]||(l[3]=a=>n.vehicleId=a),placeholder:"请选择车辆"},{default:t(()=>[(v(!0),w(C,null,U(D.value,a=>(v(),R(d,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"维修类型"},{default:t(()=>[e(f,{modelValue:n.maintenanceType,"onUpdate:modelValue":l[4]||(l[4]=a=>n.maintenanceType=a),placeholder:"请选择类型"},{default:t(()=>[e(d,{label:"定期保养",value:"定期保养"}),e(d,{label:"故障维修",value:"故障维修"}),e(d,{label:"轮胎更换",value:"轮胎更换"}),e(d,{label:"油液更换",value:"油液更换"}),e(d,{label:"制动系统维修",value:"制动系统维修"})]),_:1},8,["modelValue"])]),_:1}),e(i,{label:"维修日期"},{default:t(()=>[e(b,{modelValue:n.maintenanceDate,"onUpdate:modelValue":l[5]||(l[5]=a=>n.maintenanceDate=a),type:"date",placeholder:"选择日期"},null,8,["modelValue"])]),_:1}),e(i,{label:"维修费用"},{default:t(()=>[e(G,{modelValue:n.cost,"onUpdate:modelValue":l[6]||(l[6]=a=>n.cost=a),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1}),e(i,{label:"维修厂"},{default:t(()=>[e(k,{modelValue:n.garage,"onUpdate:modelValue":l[7]||(l[7]=a=>n.garage=a)},null,8,["modelValue"])]),_:1}),e(i,{label:"维修内容"},{default:t(()=>[e(k,{modelValue:n.description,"onUpdate:modelValue":l[8]||(l[8]=a=>n.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1}),e(i,{label:"下次保养日期"},{default:t(()=>[e(b,{modelValue:n.nextMaintenanceDate,"onUpdate:modelValue":l[9]||(l[9]=a=>n.nextMaintenanceDate=a),type:"date",placeholder:"选择日期"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ue=Z(te,[["__scopeId","data-v-90f2e793"]]);export{ue as default};
