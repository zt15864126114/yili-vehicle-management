import{i as z}from"./index-CFFsEcQF.js";import{f as N}from"./fuelRecord-siKxubu8.js";import{m as V}from"./maintenanceRecord-DlgbnOpr.js";import{v as I}from"./vehicle-lBh_cm1j.js";import{d as O,r as y,c as f,z as S,A as T,h as U,e as a,w as t,b as m,o as j,f as n,j as s,t as p,_ as q}from"./index-Dj8K2Q4U.js";import"./mock-BnFOwhRk.js";const M={class:"cost-analysis"},P={class:"card-header"},X={class:"statistics-cards"},G={class:"stat-value"},H={class:"stat-value"},J={class:"stat-value"},K={class:"stat-value"},Q={class:"charts-container"},W=O({__name:"CostAnalysis",setup(Y){const h=y("month"),_=y(),C=y();let i=null,u=null;const w=f(()=>b.value+g.value+x.value),b=f(()=>N.records.reduce((r,e)=>r+e.cost,0)),g=f(()=>V.records.reduce((r,e)=>r+e.cost,0)),x=f(()=>0),A=f(()=>I.vehicles.map(e=>{const c=N.records.filter(o=>o.vehicleId===e.id).reduce((o,l)=>o+l.cost,0),v=V.records.filter(o=>o.vehicleId===e.id).reduce((o,l)=>o+l.cost,0);return{id:e.id,plateNumber:e.plateNumber,fuelCost:c,maintenanceCost:v,totalCost:c+v}}).sort((e,c)=>c.totalCost-e.totalCost)),R=()=>{if(!_.value)return;i=z(_.value);const r={tooltip:{trigger:"item",formatter:"{b}: ¥{c} ({d}%)"},legend:{orient:"vertical",left:"left"},series:[{type:"pie",radius:"70%",data:[{value:b.value,name:"燃油费用"},{value:g.value,name:"维修保养费用"},{value:x.value,name:"其他费用"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};i.setOption(r)},k=()=>{if(!C.value)return;u=z(C.value);const r={tooltip:{trigger:"axis"},legend:{data:["燃油费用","维修保养费用","总费用"]},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月"]},yAxis:{type:"value",axisLabel:{formatter:"¥{value}"}},series:[{name:"燃油费用",type:"line",data:[5e3,4500,6e3,5500,6500,7e3]},{name:"维修保养费用",type:"line",data:[2e3,3e3,1500,2500,3500,2e3]},{name:"总费用",type:"line",data:[7e3,7500,7500,8e3,1e4,9e3]}]};u.setOption(r)},B=()=>{R(),k()},F=()=>{i==null||i.resize(),u==null||u.resize()};return S(()=>{R(),k(),window.addEventListener("resize",F)}),T(()=>{window.removeEventListener("resize",F),i==null||i.dispose(),u==null||u.dispose()}),(r,e)=>{const c=m("el-radio-button"),v=m("el-radio-group"),o=m("el-card"),l=m("el-table-column"),D=m("el-progress"),L=m("el-table");return j(),U("div",M,[a(o,null,{header:t(()=>[n("div",P,[e[4]||(e[4]=n("span",null,"费用统计分析",-1)),a(v,{modelValue:h.value,"onUpdate:modelValue":e[0]||(e[0]=d=>h.value=d),onChange:B},{default:t(()=>[a(c,{label:"month"},{default:t(()=>e[1]||(e[1]=[s("月度")])),_:1}),a(c,{label:"quarter"},{default:t(()=>e[2]||(e[2]=[s("季度")])),_:1}),a(c,{label:"year"},{default:t(()=>e[3]||(e[3]=[s("年度")])),_:1})]),_:1},8,["modelValue"])])]),default:t(()=>[n("div",X,[a(o,{class:"stat-card"},{header:t(()=>e[5]||(e[5]=[s("总费用支出")])),default:t(()=>[n("div",G,"¥"+p(w.value.toFixed(2)),1)]),_:1}),a(o,{class:"stat-card"},{header:t(()=>e[6]||(e[6]=[s("燃油费用")])),default:t(()=>[n("div",H,"¥"+p(b.value.toFixed(2)),1)]),_:1}),a(o,{class:"stat-card"},{header:t(()=>e[7]||(e[7]=[s("维修保养费用")])),default:t(()=>[n("div",J,"¥"+p(g.value.toFixed(2)),1)]),_:1}),a(o,{class:"stat-card"},{header:t(()=>e[8]||(e[8]=[s("其他费用")])),default:t(()=>[n("div",K,"¥"+p(x.value.toFixed(2)),1)]),_:1})]),n("div",Q,[a(o,{class:"chart-card"},{header:t(()=>e[9]||(e[9]=[s("费用构成")])),default:t(()=>[n("div",{ref_key:"pieChartRef",ref:_,class:"chart"},null,512)]),_:1}),a(o,{class:"chart-card"},{header:t(()=>e[10]||(e[10]=[s("费用趋势")])),default:t(()=>[n("div",{ref_key:"lineChartRef",ref:C,class:"chart"},null,512)]),_:1})]),a(o,{class:"ranking-card"},{header:t(()=>e[11]||(e[11]=[s("车辆费用排名")])),default:t(()=>[a(L,{data:A.value,border:""},{default:t(()=>[a(l,{label:"排名",type:"index",width:"80"}),a(l,{label:"车牌号",prop:"plateNumber"}),a(l,{label:"总费用",prop:"totalCost"},{default:t(({row:d})=>[s(" ¥"+p(d.totalCost.toFixed(2)),1)]),_:1}),a(l,{label:"燃油费用",prop:"fuelCost"},{default:t(({row:d})=>[s(" ¥"+p(d.fuelCost.toFixed(2)),1)]),_:1}),a(l,{label:"维修费用",prop:"maintenanceCost"},{default:t(({row:d})=>[s(" ¥"+p(d.maintenanceCost.toFixed(2)),1)]),_:1}),a(l,{label:"费用占比",width:"200"},{default:t(({row:d})=>[a(D,{percentage:(d.totalCost/w.value*100).toFixed(1),format:E=>E+"%"},null,8,["percentage","format"])]),_:1})]),_:1},8,["data"])]),_:1})]),_:1})])}}}),se=q(W,[["__scopeId","data-v-f294caa7"]]);export{se as default};
