import{d as we,r as _,B as Q,c as he,h as I,e,w as t,b as s,o as v,f as U,j as r,F as N,i as D,t as b,g as ke,a as w,G as Ue,C as Ne,E,H as De,_ as xe}from"./index-Dj8K2Q4U.js";import{M as Re}from"./mock-BnFOwhRk.js";import{v as Pe}from"./vehicle-lBh_cm1j.js";import{d as Se}from"./driver-B9Ek07UP.js";const Te=Re.mock({"records|20":[{"id|+1":1,"vehicleId|1-20":1,"driverId|1-10":1,accidentDate:'@datetime("yyyy-MM-dd HH:mm:ss")',location:"@city(true)","type|1":["碰撞","刮蹭","追尾","翻车","其他"],"severity|1":["minor","moderate","severe"],description:"@cparagraph(1, 2)","responsibility|1":["全责","主责","次责","无责"],thirdParty:{name:"@cname",phone:/1[3-9]\d{9}/,plateNumber:/[京津沪渝冀豫云辽黑湘鲁新苏浙赣鄂桂甘晋蒙陕吉闽贵粤青藏川宁琼使领][A-Z]\d{5}/},cost:{"repair|1000-50000":1,"compensation|1000-30000":1,"other|0-5000":1},"status|1":["pending","processing","completed"],handledBy:"@cname",insuranceClaim:{claimNumber:/CL\d{8}/,"claimAmount|1000-50000":1,"status|1":["待申请","已申请","已赔付","已驳回"]},"attachments|1-3":[{name:"@word(5, 10).jpg",url:'@image("200x200")',type:"image/jpeg"}]}]}),Ae={class:"accident-list"},Be={class:"card-header"},je={class:"dialog-footer"},Me={class:"image-list"},$e=we({__name:"AccidentList",setup(Ee){const V=_(Te.records),A=_(Pe.vehicles),B=_(Se.drivers),g=_(!1),j=_(!1),x=_("add"),R=_("basic"),y=_(null),M=_(!1),F=_(0),i=Q({vehicleId:"",driverId:"",type:"",status:"",dateRange:[]}),n=Q({id:"",vehicleId:"",driverId:"",accidentDate:"",location:"",type:"",severity:"",description:"",responsibility:"",thirdParty:{name:"",phone:"",plateNumber:""},cost:{repair:0,compensation:0,other:0},status:"",handledBy:"",insuranceClaim:{claimNumber:"",claimAmount:0,status:""},attachments:[]}),W=he(()=>V.value.filter(o=>{if(i.vehicleId&&o.vehicleId!==i.vehicleId||i.driverId&&o.driverId!==i.driverId||i.type&&o.type!==i.type||i.status&&o.status!==i.status)return!1;if(i.dateRange&&i.dateRange.length===2){const l=new Date(o.accidentDate),p=new Date(i.dateRange[0]),d=new Date(i.dateRange[1]);if(l<p||l>d)return!1}return!0})),O=o=>{const l=A.value.find(p=>p.id===o);return l?l.plateNumber:"-"},z=o=>{const l=B.value.find(p=>p.id===o);return l?l.name:"-"},X=o=>({minor:"info",moderate:"warning",severe:"danger"})[o],Y=o=>({minor:"轻微",moderate:"中等",severe:"严重"})[o],ee=o=>({全责:"danger",主责:"warning",次责:"info",无责:"success"})[o],le=o=>({pending:"warning",processing:"primary",completed:"success"})[o],ae=o=>({pending:"待处理",processing:"处理中",completed:"已完成"})[o],te=o=>({待申请:"info",已申请:"warning",已赔付:"success",已驳回:"danger"})[o],ne=o=>o.cost.repair+o.cost.compensation+o.cost.other,oe=()=>{},de=()=>{Object.assign(i,{vehicleId:"",driverId:"",type:"",status:"",dateRange:[]})},ie=()=>{x.value="add",g.value=!0,R.value="basic",Object.assign(n,{id:"",vehicleId:"",driverId:"",accidentDate:"",location:"",type:"",severity:"",description:"",responsibility:"",thirdParty:{name:"",phone:"",plateNumber:""},cost:{repair:0,compensation:0,other:0},status:"pending",handledBy:"",insuranceClaim:{claimNumber:"",claimAmount:0,status:"待申请"},attachments:[]})},ue=o=>{x.value="edit",g.value=!0,R.value="basic",Object.assign(n,JSON.parse(JSON.stringify(o)))},se=o=>{Ne.confirm("确定要删除该事故记录吗？","提示",{type:"warning"}).then(()=>{V.value=V.value.filter(l=>l.id!==o.id),E.success("删除成功")})},re=o=>{y.value=o,j.value=!0},me=o=>{F.value=o,M.value=!0},pe=()=>{if(x.value==="add"){const o={...n,id:String(V.value.length+1)};V.value.unshift(o),E.success("新增事故记录成功")}else{const o=V.value.findIndex(l=>l.id===n.id);o!==-1&&(V.value[o]={...n},E.success("更新事故记录成功"))}g.value=!1};return(o,l)=>{const p=s("el-button"),d=s("el-option"),f=s("el-select"),u=s("el-form-item"),L=s("el-date-picker"),H=s("el-form"),c=s("el-table-column"),P=s("el-tag"),ce=s("el-button-group"),ve=s("el-table"),be=s("el-card"),C=s("el-input"),h=s("el-tab-pane"),S=s("el-input-number"),fe=s("el-icon"),_e=s("el-upload"),ye=s("el-tabs"),J=s("el-dialog"),T=s("el-descriptions-item"),Ve=s("el-descriptions"),ge=s("el-divider"),Ce=s("el-image-viewer"),Ie=s("el-image");return v(),I("div",Ae,[e(be,null,{header:t(()=>[U("div",Be,[l[28]||(l[28]=U("span",null,"事故记录管理",-1)),e(p,{type:"primary",onClick:ie},{default:t(()=>l[27]||(l[27]=[r("新增事故记录")])),_:1})])]),default:t(()=>[e(H,{inline:!0,class:"search-form"},{default:t(()=>[e(u,{label:"车辆"},{default:t(()=>[e(f,{modelValue:i.vehicleId,"onUpdate:modelValue":l[0]||(l[0]=a=>i.vehicleId=a),placeholder:"请选择车辆",clearable:""},{default:t(()=>[(v(!0),I(N,null,D(A.value,a=>(v(),w(d,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"驾驶员"},{default:t(()=>[e(f,{modelValue:i.driverId,"onUpdate:modelValue":l[1]||(l[1]=a=>i.driverId=a),placeholder:"请选择驾驶员",clearable:""},{default:t(()=>[(v(!0),I(N,null,D(B.value,a=>(v(),w(d,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"事故类型"},{default:t(()=>[e(f,{modelValue:i.type,"onUpdate:modelValue":l[2]||(l[2]=a=>i.type=a),placeholder:"请选择类型",clearable:""},{default:t(()=>[e(d,{label:"碰撞",value:"碰撞"}),e(d,{label:"刮蹭",value:"刮蹭"}),e(d,{label:"追尾",value:"追尾"}),e(d,{label:"翻车",value:"翻车"}),e(d,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"处理状态"},{default:t(()=>[e(f,{modelValue:i.status,"onUpdate:modelValue":l[3]||(l[3]=a=>i.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(d,{label:"待处理",value:"pending"}),e(d,{label:"处理中",value:"processing"}),e(d,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"事故日期"},{default:t(()=>[e(L,{modelValue:i.dateRange,"onUpdate:modelValue":l[4]||(l[4]=a=>i.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),e(u,null,{default:t(()=>[e(p,{type:"primary",onClick:oe},{default:t(()=>l[29]||(l[29]=[r("查询")])),_:1}),e(p,{onClick:de},{default:t(()=>l[30]||(l[30]=[r("重置")])),_:1})]),_:1})]),_:1}),e(ve,{data:W.value,border:""},{default:t(()=>[e(c,{prop:"id",label:"记录编号",width:"100"}),e(c,{label:"车牌号",width:"120"},{default:t(({row:a})=>[r(b(O(a.vehicleId)),1)]),_:1}),e(c,{label:"驾驶员",width:"100"},{default:t(({row:a})=>[r(b(z(a.driverId)),1)]),_:1}),e(c,{prop:"accidentDate",label:"事故时间",width:"160"}),e(c,{prop:"location",label:"事故地点",width:"120"}),e(c,{prop:"type",label:"事故类型",width:"100"}),e(c,{prop:"severity",label:"严重程度",width:"100"},{default:t(({row:a})=>[e(P,{type:X(a.severity)},{default:t(()=>[r(b(Y(a.severity)),1)]),_:2},1032,["type"])]),_:1}),e(c,{prop:"responsibility",label:"责任认定",width:"100"},{default:t(({row:a})=>[e(P,{type:ee(a.responsibility)},{default:t(()=>[r(b(a.responsibility),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"总费用",width:"120"},{default:t(({row:a})=>[r(" ¥"+b(ne(a).toFixed(2)),1)]),_:1}),e(c,{prop:"status",label:"处理状态",width:"100"},{default:t(({row:a})=>[e(P,{type:le(a.status)},{default:t(()=>[r(b(ae(a.status)),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"保险理赔",width:"180"},{default:t(({row:a})=>[U("div",null,b(a.insuranceClaim.claimNumber),1),e(P,{size:"small",type:te(a.insuranceClaim.status)},{default:t(()=>[r(b(a.insuranceClaim.status),1)]),_:2},1032,["type"])]),_:1}),e(c,{label:"操作",width:"200",fixed:"right"},{default:t(({row:a})=>[e(ce,null,{default:t(()=>[e(p,{type:"primary",size:"small",onClick:k=>ue(a)},{default:t(()=>l[31]||(l[31]=[r("编辑")])),_:2},1032,["onClick"]),e(p,{type:"success",size:"small",onClick:k=>re(a)},{default:t(()=>l[32]||(l[32]=[r("详情")])),_:2},1032,["onClick"]),e(p,{type:"danger",size:"small",onClick:k=>se(a)},{default:t(()=>l[33]||(l[33]=[r("删除")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])]),_:1}),e(J,{modelValue:g.value,"onUpdate:modelValue":l[24]||(l[24]=a=>g.value=a),title:x.value==="add"?"新增事故记录":"编辑事故记录",width:"800px"},{footer:t(()=>[U("span",je,[e(p,{onClick:l[23]||(l[23]=a=>g.value=!1)},{default:t(()=>l[34]||(l[34]=[r("取消")])),_:1}),e(p,{type:"primary",onClick:pe},{default:t(()=>l[35]||(l[35]=[r("确定")])),_:1})])]),default:t(()=>[e(H,{model:n,"label-width":"100px"},{default:t(()=>[e(ye,{modelValue:R.value,"onUpdate:modelValue":l[22]||(l[22]=a=>R.value=a)},{default:t(()=>[e(h,{label:"基本信息",name:"basic"},{default:t(()=>[e(u,{label:"车辆"},{default:t(()=>[e(f,{modelValue:n.vehicleId,"onUpdate:modelValue":l[5]||(l[5]=a=>n.vehicleId=a),placeholder:"请选择车辆"},{default:t(()=>[(v(!0),I(N,null,D(A.value,a=>(v(),w(d,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"驾驶员"},{default:t(()=>[e(f,{modelValue:n.driverId,"onUpdate:modelValue":l[6]||(l[6]=a=>n.driverId=a),placeholder:"请选择驾驶员"},{default:t(()=>[(v(!0),I(N,null,D(B.value,a=>(v(),w(d,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"事故时间"},{default:t(()=>[e(L,{modelValue:n.accidentDate,"onUpdate:modelValue":l[7]||(l[7]=a=>n.accidentDate=a),type:"datetime",placeholder:"选择时间"},null,8,["modelValue"])]),_:1}),e(u,{label:"事故地点"},{default:t(()=>[e(C,{modelValue:n.location,"onUpdate:modelValue":l[8]||(l[8]=a=>n.location=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"事故类型"},{default:t(()=>[e(f,{modelValue:n.type,"onUpdate:modelValue":l[9]||(l[9]=a=>n.type=a),placeholder:"请选择类型"},{default:t(()=>[e(d,{label:"碰撞",value:"碰撞"}),e(d,{label:"刮蹭",value:"刮蹭"}),e(d,{label:"追尾",value:"追尾"}),e(d,{label:"翻车",value:"翻车"}),e(d,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"严重程度"},{default:t(()=>[e(f,{modelValue:n.severity,"onUpdate:modelValue":l[10]||(l[10]=a=>n.severity=a),placeholder:"请选择严重程度"},{default:t(()=>[e(d,{label:"轻微",value:"minor"}),e(d,{label:"中等",value:"moderate"}),e(d,{label:"严重",value:"severe"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"责任认定"},{default:t(()=>[e(f,{modelValue:n.responsibility,"onUpdate:modelValue":l[11]||(l[11]=a=>n.responsibility=a),placeholder:"请选择责任"},{default:t(()=>[e(d,{label:"全责",value:"全责"}),e(d,{label:"主责",value:"主责"}),e(d,{label:"次责",value:"次责"}),e(d,{label:"无责",value:"无责"})]),_:1},8,["modelValue"])]),_:1}),e(u,{label:"事故描述"},{default:t(()=>[e(C,{modelValue:n.description,"onUpdate:modelValue":l[12]||(l[12]=a=>n.description=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{label:"第三方信息",name:"thirdParty"},{default:t(()=>[e(u,{label:"姓名"},{default:t(()=>[e(C,{modelValue:n.thirdParty.name,"onUpdate:modelValue":l[13]||(l[13]=a=>n.thirdParty.name=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"联系电话"},{default:t(()=>[e(C,{modelValue:n.thirdParty.phone,"onUpdate:modelValue":l[14]||(l[14]=a=>n.thirdParty.phone=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"车牌号"},{default:t(()=>[e(C,{modelValue:n.thirdParty.plateNumber,"onUpdate:modelValue":l[15]||(l[15]=a=>n.thirdParty.plateNumber=a)},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{label:"费用信息",name:"cost"},{default:t(()=>[e(u,{label:"维修费用"},{default:t(()=>[e(S,{modelValue:n.cost.repair,"onUpdate:modelValue":l[16]||(l[16]=a=>n.cost.repair=a),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1}),e(u,{label:"赔偿费用"},{default:t(()=>[e(S,{modelValue:n.cost.compensation,"onUpdate:modelValue":l[17]||(l[17]=a=>n.cost.compensation=a),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1}),e(u,{label:"其他费用"},{default:t(()=>[e(S,{modelValue:n.cost.other,"onUpdate:modelValue":l[18]||(l[18]=a=>n.cost.other=a),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1})]),_:1}),e(h,{label:"保险理赔",name:"insurance"},{default:t(()=>[e(u,{label:"理赔编号"},{default:t(()=>[e(C,{modelValue:n.insuranceClaim.claimNumber,"onUpdate:modelValue":l[19]||(l[19]=a=>n.insuranceClaim.claimNumber=a)},null,8,["modelValue"])]),_:1}),e(u,{label:"理赔金额"},{default:t(()=>[e(S,{modelValue:n.insuranceClaim.claimAmount,"onUpdate:modelValue":l[20]||(l[20]=a=>n.insuranceClaim.claimAmount=a),min:0,precision:2,step:100},null,8,["modelValue"])]),_:1}),e(u,{label:"理赔状态"},{default:t(()=>[e(f,{modelValue:n.insuranceClaim.status,"onUpdate:modelValue":l[21]||(l[21]=a=>n.insuranceClaim.status=a),placeholder:"请选择状态"},{default:t(()=>[e(d,{label:"待申请",value:"待申请"}),e(d,{label:"已申请",value:"已申请"}),e(d,{label:"已赔付",value:"已赔付"}),e(d,{label:"已驳回",value:"已驳回"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(h,{label:"附件",name:"attachments"},{default:t(()=>[e(_e,{action:"#","list-type":"picture-card","auto-upload":!1},{default:t(()=>[e(fe,null,{default:t(()=>[e(ke(De))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(J,{modelValue:j.value,"onUpdate:modelValue":l[26]||(l[26]=a=>j.value=a),title:"事故详情",width:"800px"},{default:t(()=>{var a,k,G;return[e(Ve,{column:2,border:""},{default:t(()=>[e(T,{label:"车牌号"},{default:t(()=>{var m;return[r(b(O((m=y.value)==null?void 0:m.vehicleId)),1)]}),_:1}),e(T,{label:"驾驶员"},{default:t(()=>{var m;return[r(b(z((m=y.value)==null?void 0:m.driverId)),1)]}),_:1}),e(T,{label:"事故时间"},{default:t(()=>{var m;return[r(b((m=y.value)==null?void 0:m.accidentDate),1)]}),_:1}),e(T,{label:"事故地点"},{default:t(()=>{var m;return[r(b((m=y.value)==null?void 0:m.location),1)]}),_:1})]),_:1}),e(ge,null,{default:t(()=>l[36]||(l[36]=[r("事故照片")])),_:1}),M.value?(v(),w(Ce,{key:0,"initial-index":F.value,"url-list":((k=(a=y.value)==null?void 0:a.attachments)==null?void 0:k.map(m=>m.url))||[],onClose:l[25]||(l[25]=m=>M.value=!1)},null,8,["initial-index","url-list"])):Ue("",!0),U("div",Me,[(v(!0),I(N,null,D((G=y.value)==null?void 0:G.attachments,(m,$)=>{var Z,q;return v(),w(Ie,{key:$,src:m.url,"preview-src-list":(q=(Z=y.value)==null?void 0:Z.attachments)==null?void 0:q.map(K=>K.url),"initial-index":$,fit:"cover",class:"accident-image",onClick:K=>me($)},null,8,["src","preview-src-list","initial-index","onClick"])}),128))])]}),_:1},8,["modelValue"])])}}}),He=xe($e,[["__scopeId","data-v-2b911046"]]);export{He as default};
