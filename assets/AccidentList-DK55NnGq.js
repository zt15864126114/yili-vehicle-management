import{d as fe,r as f,c as L,h as k,e,w as t,b as m,o as y,f as C,j as i,t as c,F as U,i as I,C as ge,E as be,B as q,a as A,_ as he}from"./index-xhAZHyxu.js";const _e={class:"accident-list"},ye={class:"card-header"},Ve={class:"table-container"},Ne={class:"pagination-container"},Me={class:"dialog-footer"},we={key:0,class:"accident-photos"},ke=fe({__name:"AccidentList",setup(Ce){const $=f("calc(100vh - 280px)"),V=f(1),F=f(10),M=f(!1),R=f(!1),j=f("add"),N=f(),p=f({}),u=f({vehicleNumber:"",driverName:"",level:"",status:"",dateRange:[]}),n=f({id:"",vehicleId:"",vehicleNumber:"",driverId:"",driverName:"",accidentTime:"",location:"",level:"",status:"pending",cost:0,responsibility:"",description:"",process:"",remarks:"",photos:[]}),S=f([{id:"1",plateNumber:"鲁H85697"},{id:"2",plateNumber:"鲁H67M89"},{id:"3",plateNumber:"鲁H2N680"},{id:"4",plateNumber:"鲁H1U579"},{id:"5",plateNumber:"鲁HK7K11"}]),z=f([{id:"1",name:"张志强"},{id:"2",name:"李建国"},{id:"3",name:"王大明"},{id:"4",name:"刘海洋"},{id:"5",name:"赵国强"}]),w=f((()=>{const o=[],l=["济南市历下区经十路与解放路交叉口","济南市天桥区无影山路与北园路交叉口","济南市槐荫区经二路与纬二路交叉口","济南市市中区英雄山路与经四路交叉口","济南市历城区工业北路与花园路交叉口"],d=[["https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe.zj.gov.cn%2Fart%2F2022%2F4%2F13%2Fart_1229536674_4837160.jpg","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe.zj.gov.cn%2Fart%2F2022%2F4%2F13%2Fart_1229536674_4837161.jpg","https://gimg2.baidu.com/image_search/src=http%3A%2F%2Fsafe.zj.gov.cn%2Fart%2F2022%2F4%2F13%2Fart_1229536674_4837162.jpg"],["https://pics7.baidu.com/feed/63d0f703918fa0ec316c75e51e1976fb9e3f939d.jpeg","https://pics6.baidu.com/feed/63d0f703918fa0ec316c75e51e1976fb9e3f939e.jpeg"],["https://pics5.baidu.com/feed/472309f790529822d1e98324cf0971cbb0717e3f.jpeg","https://pics4.baidu.com/feed/472309f790529822d1e98324cf0971cbb0717e40.jpeg","https://pics3.baidu.com/feed/472309f790529822d1e98324cf0971cbb0717e41.jpeg"],["https://img0.baidu.com/it/u=1831379088,3147101487&fm=253&fmt=auto&app=120&f=JPEG","https://img1.baidu.com/it/u=1831379088,3147101487&fm=253&fmt=auto&app=120&f=JPEG"],["https://img2.baidu.com/it/u=2619193114,3071890484&fm=253&fmt=auto&app=120&f=JPEG","https://img3.baidu.com/it/u=2619193114,3071890484&fm=253&fmt=auto&app=120&f=JPEG","https://img4.baidu.com/it/u=2619193114,3071890484&fm=253&fmt=auto&app=120&f=JPEG"]];for(let v=0;v<30;v++){const r=new Date;r.setDate(r.getDate()-Math.floor(Math.random()*180)),o.push({id:String(v+1),vehicleId:String(Math.floor(Math.random()*5)+1),vehicleNumber:S.value[Math.floor(Math.random()*5)].plateNumber,driverId:String(Math.floor(Math.random()*5)+1),driverName:z.value[Math.floor(Math.random()*5)].name,accidentTime:r.toISOString().slice(0,16).replace("T"," "),location:l[Math.floor(Math.random()*l.length)],level:["minor","normal","major"][Math.floor(Math.random()*3)],status:["pending","processing","completed"][Math.floor(Math.random()*3)],cost:Math.floor(Math.random()*5e4)+1e3,responsibility:["full","major","minor","none"][Math.floor(Math.random()*4)],description:"车辆在行驶过程中发生碰撞事故，造成车辆不同程度受损。需要进行维修和保险理赔。",process:"已联系保险公司，正在进行定损评估。维修厂已完成初步检查，等待配件到货进行维修。",remarks:"",photos:d[Math.floor(Math.random()*d.length)]})}return o})()),B=L(()=>w.value.filter(o=>{var h;const l=!u.value.vehicleNumber||o.vehicleNumber.includes(u.value.vehicleNumber),d=!u.value.driverName||o.driverName.includes(u.value.driverName),v=!u.value.level||o.level===u.value.level,r=!u.value.status||o.status===u.value.status;let s=!0;if(((h=u.value.dateRange)==null?void 0:h.length)===2){const x=new Date(o.accidentTime).getTime(),T=new Date(u.value.dateRange[0]).getTime(),g=new Date(u.value.dateRange[1]).getTime()+24*60*60*1e3;s=x>=T&&x<=g}return l&&d&&v&&r&&s})),K=L(()=>{const o=(V.value-1)*F.value,l=o+F.value;return B.value.slice(o,l)}),O={vehicleId:[{required:!0,message:"请选择车辆",trigger:["blur","change"]}],driverId:[{required:!0,message:"请选择驾驶员",trigger:["blur","change"]}],accidentTime:[{required:!0,message:"请选择事故时间",trigger:["blur","change"]}],location:[{required:!0,message:"请输入事故地点",trigger:"blur"}],level:[{required:!0,message:"请选择事故等级",trigger:["blur","change"]}],status:[{required:!0,message:"请选择处理状态",trigger:["blur","change"]}],cost:[{required:!0,message:"请输入损失金额",trigger:"blur"}],responsibility:[{required:!0,message:"请选择责任认定",trigger:["blur","change"]}],description:[{required:!0,message:"请输入事故描述",trigger:"blur"}]},Q=o=>{const l=S.value.find(d=>d.id===o);l&&(n.value.vehicleNumber=l.plateNumber)},W=o=>{const l=z.value.find(d=>d.id===o);l&&(n.value.driverName=l.name)},X=o=>{F.value=o,V.value=1},Z=o=>{V.value=o},ee=()=>{V.value=1},le=()=>{u.value={vehicleNumber:"",driverName:"",level:"",status:"",dateRange:[]},V.value=1},ae=o=>{p.value=o,R.value=!0},te=()=>{j.value="add",n.value={id:"",vehicleId:"",vehicleNumber:"",driverId:"",driverName:"",accidentTime:"",location:"",level:"",status:"pending",cost:0,responsibility:"",description:"",process:"",remarks:"",photos:[]},M.value=!0,N.value&&N.value.clearValidate()},oe=o=>{j.value="edit",n.value={...o},M.value=!0,N.value&&N.value.clearValidate()},ne=o=>{be.confirm("确定要删除该事故记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{w.value=w.value.filter(l=>l.id!==o.id),q.success("删除成功")}).catch(()=>{})},ue=async()=>{N.value&&await N.value.validate((o,l)=>{if(o){if(j.value==="add"){const d={...n.value,id:String(Date.now()),photos:[]};w.value.unshift(d),q.success("新增成功")}else{const d=w.value.findIndex(v=>v.id===n.value.id);d!==-1&&(w.value[d]={...n.value},q.success("更新成功"))}M.value=!1}else console.log("验证失败",l)})},H={pending:"待处理",processing:"处理中",completed:"已完成"},Y={minor:"轻微",normal:"一般",major:"重大"},E={full:"全责",major:"主责",minor:"次责",none:"无责"},P=o=>({pending:"warning",processing:"primary",completed:"success"})[o]||"info",G=o=>({minor:"success",normal:"warning",major:"danger"})[o]||"info",re=o=>({full:"danger",major:"warning",minor:"info",none:"success"})[o]||"info";return(o,l)=>{const d=m("el-button"),v=m("el-input"),r=m("el-form-item"),s=m("el-option"),h=m("el-select"),x=m("el-date-picker"),T=m("el-form"),g=m("el-table-column"),D=m("el-tag"),ie=m("el-table"),de=m("el-pagination"),se=m("el-card"),pe=m("el-input-number"),J=m("el-dialog"),b=m("el-descriptions-item"),me=m("el-descriptions"),ce=m("el-image");return y(),k("div",_e,[e(se,{class:"accident-card"},{header:t(()=>[C("div",ye,[l[22]||(l[22]=C("span",null,"事故记录",-1)),e(d,{type:"primary",onClick:te},{default:t(()=>l[21]||(l[21]=[i("新增记录")])),_:1})])]),default:t(()=>[e(T,{inline:!0,model:u.value,class:"search-form"},{default:t(()=>[e(r,{label:"车牌号"},{default:t(()=>[e(v,{modelValue:u.value.vehicleNumber,"onUpdate:modelValue":l[0]||(l[0]=a=>u.value.vehicleNumber=a),placeholder:"请输入车牌号"},null,8,["modelValue"])]),_:1}),e(r,{label:"驾驶员"},{default:t(()=>[e(v,{modelValue:u.value.driverName,"onUpdate:modelValue":l[1]||(l[1]=a=>u.value.driverName=a),placeholder:"请输入驾驶员姓名"},null,8,["modelValue"])]),_:1}),e(r,{label:"事故等级"},{default:t(()=>[e(h,{modelValue:u.value.level,"onUpdate:modelValue":l[2]||(l[2]=a=>u.value.level=a),placeholder:"请选择等级",clearable:""},{default:t(()=>[e(s,{label:"轻微",value:"minor"}),e(s,{label:"一般",value:"normal"}),e(s,{label:"重大",value:"major"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"处理状态"},{default:t(()=>[e(h,{modelValue:u.value.status,"onUpdate:modelValue":l[3]||(l[3]=a=>u.value.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(s,{label:"待处理",value:"pending"}),e(s,{label:"处理中",value:"processing"}),e(s,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"事故日期"},{default:t(()=>[e(x,{modelValue:u.value.dateRange,"onUpdate:modelValue":l[4]||(l[4]=a=>u.value.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(r,null,{default:t(()=>[e(d,{type:"primary",onClick:ee},{default:t(()=>l[23]||(l[23]=[i("搜索")])),_:1}),e(d,{onClick:le},{default:t(()=>l[24]||(l[24]=[i("重置")])),_:1})]),_:1})]),_:1},8,["model"]),C("div",Ve,[e(ie,{data:K.value,style:{width:"100%"},height:$.value},{default:t(()=>[e(g,{prop:"vehicleNumber",label:"车牌号",width:"120"}),e(g,{prop:"driverName",label:"驾驶员",width:"100"}),e(g,{prop:"accidentTime",label:"事故时间",width:"160"}),e(g,{prop:"location",label:"事故地点","min-width":"180"}),e(g,{prop:"level",label:"事故等级",width:"100"},{default:t(({row:a})=>[e(D,{type:G(a.level)},{default:t(()=>[i(c(Y[a.level]),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"status",label:"处理状态",width:"100"},{default:t(({row:a})=>[e(D,{type:P(a.status)},{default:t(()=>[i(c(H[a.status]),1)]),_:2},1032,["type"])]),_:1}),e(g,{prop:"cost",label:"损失金额",width:"120"},{default:t(({row:a})=>[i(" ¥"+c(a.cost.toFixed(2)),1)]),_:1}),e(g,{prop:"responsibility",label:"责任认定",width:"120"},{default:t(({row:a})=>[e(D,{type:re(a.responsibility)},{default:t(()=>[i(c(E[a.responsibility]),1)]),_:2},1032,["type"])]),_:1}),e(g,{label:"操作",width:"180",fixed:"right"},{default:t(({row:a})=>[e(d,{type:"primary",link:"",onClick:_=>ae(a)},{default:t(()=>l[25]||(l[25]=[i("查看")])),_:2},1032,["onClick"]),e(d,{type:"primary",link:"",onClick:_=>oe(a)},{default:t(()=>l[26]||(l[26]=[i("编辑")])),_:2},1032,["onClick"]),e(d,{type:"danger",link:"",onClick:_=>ne(a)},{default:t(()=>l[27]||(l[27]=[i("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","height"])]),C("div",Ne,[e(de,{"current-page":V.value,"onUpdate:currentPage":l[5]||(l[5]=a=>V.value=a),"page-size":F.value,"onUpdate:pageSize":l[6]||(l[6]=a=>F.value=a),"page-sizes":[10,15,20,30],total:B.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:X,onCurrentChange:Z,background:""},null,8,["current-page","page-size","total"])])]),_:1}),e(J,{title:j.value==="add"?"新增事故记录":"编辑事故记录",modelValue:M.value,"onUpdate:modelValue":l[19]||(l[19]=a=>M.value=a),width:"600px"},{footer:t(()=>[C("span",Me,[e(d,{onClick:l[18]||(l[18]=a=>M.value=!1)},{default:t(()=>l[28]||(l[28]=[i("取消")])),_:1}),e(d,{type:"primary",onClick:ue},{default:t(()=>l[29]||(l[29]=[i("确定")])),_:1})])]),default:t(()=>[e(T,{ref_key:"formRef",ref:N,model:n.value,rules:O,"label-width":"100px",style:{"max-height":"60vh","overflow-y":"auto"}},{default:t(()=>[e(r,{label:"车辆",prop:"vehicleId"},{default:t(()=>[e(h,{modelValue:n.value.vehicleId,"onUpdate:modelValue":l[7]||(l[7]=a=>n.value.vehicleId=a),placeholder:"请选择车辆",style:{width:"100%"},onChange:Q},{default:t(()=>[(y(!0),k(U,null,I(S.value,a=>(y(),A(s,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"驾驶员",prop:"driverId"},{default:t(()=>[e(h,{modelValue:n.value.driverId,"onUpdate:modelValue":l[8]||(l[8]=a=>n.value.driverId=a),placeholder:"请选择驾驶员",style:{width:"100%"},onChange:W},{default:t(()=>[(y(!0),k(U,null,I(z.value,a=>(y(),A(s,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"事故时间",prop:"accidentTime"},{default:t(()=>[e(x,{modelValue:n.value.accidentTime,"onUpdate:modelValue":l[9]||(l[9]=a=>n.value.accidentTime=a),type:"datetime",placeholder:"选择事故时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm"},null,8,["modelValue"])]),_:1}),e(r,{label:"事故地点",prop:"location"},{default:t(()=>[e(v,{modelValue:n.value.location,"onUpdate:modelValue":l[10]||(l[10]=a=>n.value.location=a),placeholder:"请输入事故地点"},null,8,["modelValue"])]),_:1}),e(r,{label:"事故等级",prop:"level"},{default:t(()=>[e(h,{modelValue:n.value.level,"onUpdate:modelValue":l[11]||(l[11]=a=>n.value.level=a),placeholder:"请选择事故等级",style:{width:"100%"}},{default:t(()=>[e(s,{label:"轻微",value:"minor"}),e(s,{label:"一般",value:"normal"}),e(s,{label:"重大",value:"major"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"处理状态",prop:"status"},{default:t(()=>[e(h,{modelValue:n.value.status,"onUpdate:modelValue":l[12]||(l[12]=a=>n.value.status=a),placeholder:"请选择处理状态",style:{width:"100%"}},{default:t(()=>[e(s,{label:"待处理",value:"pending"}),e(s,{label:"处理中",value:"processing"}),e(s,{label:"已完成",value:"completed"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"损失金额",prop:"cost"},{default:t(()=>[e(pe,{modelValue:n.value.cost,"onUpdate:modelValue":l[13]||(l[13]=a=>n.value.cost=a),min:0,precision:2,step:1e3,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),e(r,{label:"责任认定",prop:"responsibility"},{default:t(()=>[e(h,{modelValue:n.value.responsibility,"onUpdate:modelValue":l[14]||(l[14]=a=>n.value.responsibility=a),placeholder:"请选择责任认定",style:{width:"100%"}},{default:t(()=>[(y(),k(U,null,I(E,(a,_)=>e(s,{key:_,label:a,value:_},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"事故描述",prop:"description"},{default:t(()=>[e(v,{modelValue:n.value.description,"onUpdate:modelValue":l[15]||(l[15]=a=>n.value.description=a),type:"textarea",rows:"3",placeholder:"请输入事故详细描述"},null,8,["modelValue"])]),_:1}),e(r,{label:"处理过程",prop:"process"},{default:t(()=>[e(v,{modelValue:n.value.process,"onUpdate:modelValue":l[16]||(l[16]=a=>n.value.process=a),type:"textarea",rows:"3",placeholder:"请输入事故处理过程"},null,8,["modelValue"])]),_:1}),e(r,{label:"备注",prop:"remarks"},{default:t(()=>[e(v,{modelValue:n.value.remarks,"onUpdate:modelValue":l[17]||(l[17]=a=>n.value.remarks=a),type:"textarea",rows:"3",placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"]),e(J,{title:"事故详情",modelValue:R.value,"onUpdate:modelValue":l[20]||(l[20]=a=>R.value=a),width:"700px"},{default:t(()=>{var a;return[e(me,{column:2,border:""},{default:t(()=>[e(b,{label:"车牌号"},{default:t(()=>[i(c(p.value.vehicleNumber),1)]),_:1}),e(b,{label:"驾驶员"},{default:t(()=>[i(c(p.value.driverName),1)]),_:1}),e(b,{label:"事故时间"},{default:t(()=>[i(c(p.value.accidentTime),1)]),_:1}),e(b,{label:"事故地点"},{default:t(()=>[i(c(p.value.location),1)]),_:1}),e(b,{label:"事故等级"},{default:t(()=>[e(D,{type:G(p.value.level)},{default:t(()=>[i(c(Y[p.value.level]),1)]),_:1},8,["type"])]),_:1}),e(b,{label:"处理状态"},{default:t(()=>[e(D,{type:P(p.value.status)},{default:t(()=>[i(c(H[p.value.status]),1)]),_:1},8,["type"])]),_:1}),e(b,{label:"损失金额"},{default:t(()=>{var _;return[i("¥"+c((_=p.value.cost)==null?void 0:_.toFixed(2)),1)]}),_:1}),e(b,{label:"责任认定"},{default:t(()=>[i(c(E[p.value.responsibility]),1)]),_:1}),e(b,{label:"事故描述",span:2},{default:t(()=>[i(c(p.value.description||"无"),1)]),_:1}),e(b,{label:"处理过程",span:2},{default:t(()=>[i(c(p.value.process||"无"),1)]),_:1}),e(b,{label:"备注",span:2},{default:t(()=>[i(c(p.value.remarks||"无"),1)]),_:1})]),_:1}),(a=p.value.photos)!=null&&a.length?(y(),k("div",we,[l[30]||(l[30]=C("h4",null,"事故照片",-1)),(y(!0),k(U,null,I(p.value.photos,(_,ve)=>(y(),A(ce,{key:ve,src:_,"preview-src-list":p.value.photos,fit:"cover",class:"accident-photo"},null,8,["src","preview-src-list"]))),128))])):ge("",!0)]}),_:1},8,["modelValue"])])}}}),De=he(ke,[["__scopeId","data-v-25d2056b"]]);export{De as default};
