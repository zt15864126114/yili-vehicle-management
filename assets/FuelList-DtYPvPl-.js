import{d as le,r as v,c as S,h as P,e as l,w as t,b as i,o as k,f as T,j as m,t as M,F as ae,i as te,E as oe,B as C,a as ue,_ as ne}from"./index-xhAZHyxu.js";const re={class:"fuel-list"},de={class:"card-header"},ie={class:"table-container"},se={class:"pagination-container"},me={class:"dialog-footer"},pe="calc(100vh - 330px)",ce=le({__name:"FuelList",setup(ve){const d=v({vehicleNumber:"",fuelType:"",dateRange:[]}),I={gasoline:"汽油",diesel:"柴油"},F=()=>{const u=["鲁H85697","鲁H67M89","鲁H2N680","鲁H1U579","鲁HK7K11","鲁H9M229","鲁H3S338","鲁H4K472"],e=["中国石化兖州第一加油站","中国石油兖州西加油站","中国石化兖州南加油站","中国石油兖州北加油站","壳牌兖州加油站"],n=["张明","李强","王华","赵伟","刘勇"];return Array.from({length:50},(s,r)=>{const p=Math.random()>.3?"diesel":"gasoline",_=p==="diesel"?7.5+Math.random()*.5:8.2+Math.random()*.5,V=Math.floor(Math.random()*200)+100;return{id:String(r+1),vehicleId:String(Math.floor(Math.random()*8)+1),vehicleNumber:u[Math.floor(Math.random()*u.length)],fuelTime:q(1).replace("T"," "),fuelType:p,volume:V,unitPrice:_,cost:+(V*_).toFixed(2),currentMileage:Math.floor(Math.random()*5e4)+1e5,location:e[Math.floor(Math.random()*e.length)],handler:n[Math.floor(Math.random()*n.length)],remarks:""}})},q=(u=1)=>{const e=new Date,n=new Date(e.getTime()-u*30*24*60*60*1e3),s=n.getTime()+Math.random()*(e.getTime()-n.getTime());return new Date(s).toISOString().slice(0,16)},f=v(F()),g=v(1),y=v(10),x=S(()=>f.value.filter(u=>{var r;const e=!d.value.vehicleNumber||u.vehicleNumber.includes(d.value.vehicleNumber),n=!d.value.fuelType||u.fuelType===d.value.fuelType;let s=!0;if(((r=d.value.dateRange)==null?void 0:r.length)===2){const p=u.fuelTime.split(" ")[0];s=p>=d.value.dateRange[0]&&p<=d.value.dateRange[1]}return e&&n&&s}).sort((u,e)=>new Date(e.fuelTime).getTime()-new Date(u.fuelTime).getTime())),z=S(()=>{const u=(g.value-1)*y.value,e=u+y.value;return x.value.slice(u,e)}),b=v(!1),w=v("add"),h=v(),H=v([{id:"1",plateNumber:"鲁H85697"},{id:"2",plateNumber:"鲁H67M89"},{id:"3",plateNumber:"鲁H2N680"},{id:"4",plateNumber:"鲁H1U579"},{id:"5",plateNumber:"鲁HK7K11"},{id:"6",plateNumber:"鲁H9M229"},{id:"7",plateNumber:"鲁H3S338"},{id:"8",plateNumber:"鲁H4K472"}]),o=v({vehicleId:"",vehicleNumber:"",fuelTime:"",fuelType:"",volume:0,unitPrice:0,cost:0,currentMileage:0,location:"",handler:"",remarks:""}),B={vehicleId:[{required:!0,message:"请选择车辆",trigger:["blur","change"]}],fuelTime:[{required:!0,message:"请选择加油时间",trigger:["blur","change"]}],fuelType:[{required:!0,message:"请选择油品类型",trigger:["blur","change"]}],volume:[{required:!0,message:"请输入加油量",trigger:"blur"}],unitPrice:[{required:!0,message:"请输入单价",trigger:"blur"}],currentMileage:[{required:!0,message:"请输入当前里程",trigger:"blur"}],location:[{required:!0,message:"请输入加油站",trigger:"blur"}],handler:[{required:!0,message:"请输入经办人",trigger:"blur"}]},Y=u=>{const e=H.value.find(n=>n.id===u);e&&(o.value.vehicleNumber=e.plateNumber)},U=()=>{o.value.volume&&o.value.unitPrice&&(o.value.cost=+(o.value.volume*o.value.unitPrice).toFixed(2))},K=u=>{y.value=u,g.value=1},E=u=>{g.value=u},L=()=>{g.value=1},$=()=>{d.value={vehicleNumber:"",fuelType:"",dateRange:[]},g.value=1},j=()=>{w.value="add",o.value={vehicleId:"",vehicleNumber:"",fuelTime:"",fuelType:"",volume:0,unitPrice:0,cost:0,currentMileage:0,location:"",handler:"",remarks:""},b.value=!0,h.value&&h.value.clearValidate()},D=v(""),A=u=>{D.value=u.id,w.value="edit",o.value={...u},b.value=!0,h.value&&h.value.clearValidate()},O=u=>{oe.confirm("确定要删除该加油记录吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.value=f.value.filter(e=>e.id!==u.id),C.success("删除成功")})},G=async()=>{h.value&&await h.value.validate((u,e)=>{if(u){if(w.value==="add"){const n={id:String(Date.now()),...o.value};f.value.unshift(n),C.success("新增成功")}else{const n=f.value.findIndex(s=>s.id===D.value);n!==-1&&(f.value[n]={...f.value[n],...o.value},C.success("更新成功"))}b.value=!1}else console.log("验证失败",e)})};return(u,e)=>{const n=i("el-button"),s=i("el-input"),r=i("el-form-item"),p=i("el-option"),_=i("el-select"),V=i("el-date-picker"),R=i("el-form"),c=i("el-table-column"),J=i("el-tag"),Q=i("el-table"),W=i("el-pagination"),X=i("el-card"),N=i("el-input-number"),Z=i("el-dialog");return k(),P("div",re,[l(X,{class:"fuel-card"},{header:t(()=>[T("div",de,[e[18]||(e[18]=T("span",null,"加油记录",-1)),l(n,{type:"primary",onClick:j},{default:t(()=>e[17]||(e[17]=[m("新增记录")])),_:1})])]),default:t(()=>[l(R,{inline:!0,model:d.value,class:"search-form"},{default:t(()=>[l(r,{label:"车牌号"},{default:t(()=>[l(s,{modelValue:d.value.vehicleNumber,"onUpdate:modelValue":e[0]||(e[0]=a=>d.value.vehicleNumber=a),placeholder:"请输入车牌号"},null,8,["modelValue"])]),_:1}),l(r,{label:"加油类型"},{default:t(()=>[l(_,{modelValue:d.value.fuelType,"onUpdate:modelValue":e[1]||(e[1]=a=>d.value.fuelType=a),placeholder:"请选择类型",clearable:""},{default:t(()=>[l(p,{label:"汽油",value:"gasoline"}),l(p,{label:"柴油",value:"diesel"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"加油日期"},{default:t(()=>[l(V,{modelValue:d.value.dateRange,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value.dateRange=a),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),l(r,null,{default:t(()=>[l(n,{type:"primary",onClick:L},{default:t(()=>e[19]||(e[19]=[m("搜索")])),_:1}),l(n,{onClick:$},{default:t(()=>e[20]||(e[20]=[m("重置")])),_:1})]),_:1})]),_:1},8,["model"]),T("div",ie,[l(Q,{data:z.value,style:{width:"100%"},height:pe},{default:t(()=>[l(c,{prop:"vehicleNumber",label:"车牌号",width:"120"}),l(c,{prop:"fuelTime",label:"加油时间",width:"160"}),l(c,{prop:"fuelType",label:"油品类型",width:"100"},{default:t(({row:a})=>[l(J,{type:a.fuelType==="gasoline"?"success":"warning"},{default:t(()=>[m(M(I[a.fuelType]),1)]),_:2},1032,["type"])]),_:1}),l(c,{prop:"volume",label:"加油量",width:"100"},{default:t(({row:a})=>[m(M(a.volume)+"L ",1)]),_:1}),l(c,{prop:"unitPrice",label:"单价",width:"100"},{default:t(({row:a})=>[m(" ¥"+M(a.unitPrice.toFixed(2)),1)]),_:1}),l(c,{prop:"cost",label:"总金额",width:"120"},{default:t(({row:a})=>[m(" ¥"+M(a.cost.toFixed(2)),1)]),_:1}),l(c,{prop:"currentMileage",label:"当前里程",width:"120"},{default:t(({row:a})=>[m(M(a.currentMileage)+"km ",1)]),_:1}),l(c,{prop:"location",label:"加油站","min-width":"180"}),l(c,{prop:"handler",label:"经办人",width:"100"}),l(c,{label:"操作",width:"150",fixed:"right"},{default:t(({row:a})=>[l(n,{type:"primary",link:"",onClick:ee=>A(a)},{default:t(()=>e[21]||(e[21]=[m("编辑")])),_:2},1032,["onClick"]),l(n,{type:"danger",link:"",onClick:ee=>O(a)},{default:t(()=>e[22]||(e[22]=[m("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),T("div",se,[l(W,{"current-page":g.value,"onUpdate:currentPage":e[3]||(e[3]=a=>g.value=a),"page-size":y.value,"onUpdate:pageSize":e[4]||(e[4]=a=>y.value=a),"page-sizes":[10,15,20,30],total:x.value.length,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:K,onCurrentChange:E,background:""},null,8,["current-page","page-size","total"])])]),_:1}),l(Z,{title:w.value==="add"?"新增加油记录":"编辑加油记录",modelValue:b.value,"onUpdate:modelValue":e[16]||(e[16]=a=>b.value=a),width:"500px"},{footer:t(()=>[T("span",me,[l(n,{onClick:e[15]||(e[15]=a=>b.value=!1)},{default:t(()=>e[23]||(e[23]=[m("取消")])),_:1}),l(n,{type:"primary",onClick:G},{default:t(()=>e[24]||(e[24]=[m("确定")])),_:1})])]),default:t(()=>[l(R,{ref_key:"formRef",ref:h,model:o.value,rules:B,"label-width":"100px",style:{"max-height":"60vh","overflow-y":"auto"}},{default:t(()=>[l(r,{label:"车辆",prop:"vehicleId"},{default:t(()=>[l(_,{modelValue:o.value.vehicleId,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value.vehicleId=a),placeholder:"请选择车辆",style:{width:"100%"},onChange:Y},{default:t(()=>[(k(!0),P(ae,null,te(H.value,a=>(k(),ue(p,{key:a.id,label:a.plateNumber,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"加油时间",prop:"fuelTime"},{default:t(()=>[l(V,{modelValue:o.value.fuelTime,"onUpdate:modelValue":e[6]||(e[6]=a=>o.value.fuelTime=a),type:"datetime",placeholder:"选择加油时间",style:{width:"100%"},"value-format":"YYYY-MM-DD HH:mm"},null,8,["modelValue"])]),_:1}),l(r,{label:"油品类型",prop:"fuelType"},{default:t(()=>[l(_,{modelValue:o.value.fuelType,"onUpdate:modelValue":e[7]||(e[7]=a=>o.value.fuelType=a),placeholder:"请选择油品类型",style:{width:"100%"}},{default:t(()=>[l(p,{label:"汽油",value:"gasoline"}),l(p,{label:"柴油",value:"diesel"})]),_:1},8,["modelValue"])]),_:1}),l(r,{label:"加油量",prop:"volume"},{default:t(()=>[l(N,{modelValue:o.value.volume,"onUpdate:modelValue":e[8]||(e[8]=a=>o.value.volume=a),min:1,precision:2,step:10,style:{width:"100%"},onChange:U},null,8,["modelValue"])]),_:1}),l(r,{label:"单价",prop:"unitPrice"},{default:t(()=>[l(N,{modelValue:o.value.unitPrice,"onUpdate:modelValue":e[9]||(e[9]=a=>o.value.unitPrice=a),min:0,precision:2,step:.1,style:{width:"100%"},onChange:U},null,8,["modelValue"])]),_:1}),l(r,{label:"总金额",prop:"cost"},{default:t(()=>[l(N,{modelValue:o.value.cost,"onUpdate:modelValue":e[10]||(e[10]=a=>o.value.cost=a),min:0,precision:2,step:10,style:{width:"100%"},disabled:""},null,8,["modelValue"])]),_:1}),l(r,{label:"当前里程",prop:"currentMileage"},{default:t(()=>[l(N,{modelValue:o.value.currentMileage,"onUpdate:modelValue":e[11]||(e[11]=a=>o.value.currentMileage=a),min:0,step:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),l(r,{label:"加油站",prop:"location"},{default:t(()=>[l(s,{modelValue:o.value.location,"onUpdate:modelValue":e[12]||(e[12]=a=>o.value.location=a),placeholder:"请输入加油站名称"},null,8,["modelValue"])]),_:1}),l(r,{label:"经办人",prop:"handler"},{default:t(()=>[l(s,{modelValue:o.value.handler,"onUpdate:modelValue":e[13]||(e[13]=a=>o.value.handler=a),placeholder:"请输入经办人"},null,8,["modelValue"])]),_:1}),l(r,{label:"备注",prop:"remarks"},{default:t(()=>[l(s,{modelValue:o.value.remarks,"onUpdate:modelValue":e[14]||(e[14]=a=>o.value.remarks=a),type:"textarea",rows:"3",placeholder:"请输入备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["title","modelValue"])])}}}),ge=ne(ce,[["__scopeId","data-v-a6bc8239"]]);export{ge as default};
